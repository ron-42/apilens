#name: CI
#
#on:
#  push:
#    branches: [main, develop]
#  pull_request:
#    branches: [main, develop]
#
#env:
#  PYTHON_VERSION: "3.11"
#  NODE_VERSION: "18"
#
#jobs:
#  # ===========================================================================
#  # Backend Tests
#  # ===========================================================================
#  backend-tests:
#    name: Backend Tests
#    runs-on: ubuntu-latest
#
#    services:
#      postgres:
#        image: postgres:15-alpine
#        env:
#          POSTGRES_USER: test
#          POSTGRES_PASSWORD: test
#          POSTGRES_DB: test
#        ports:
#          - 5432:5432
#        options: >-
#          --health-cmd pg_isready
#          --health-interval 10s
#          --health-timeout 5s
#          --health-retries 5
#
#      redis:
#        image: redis:7-alpine
#        ports:
#          - 6379:6379
#        options: >-
#          --health-cmd "redis-cli ping"
#          --health-interval 10s
#          --health-timeout 5s
#          --health-retries 5
#
#    env:
#      DJANGO_SETTINGS_MODULE: config.settings.development
#      POSTGRES_DB: test
#      POSTGRES_USER: test
#      POSTGRES_PASSWORD: test
#      POSTGRES_HOST: localhost
#      POSTGRES_PORT: 5432
#      REDIS_URL: redis://localhost:6379/0
#
#    steps:
#      - name: Checkout code
#        uses: actions/checkout@v4
#
#      - name: Install UV
#        uses: astral-sh/setup-uv@v4
#        with:
#          version: "latest"
#
#      - name: Set up Python
#        uses: actions/setup-python@v5
#        with:
#          python-version: ${{ env.PYTHON_VERSION }}
#
#      - name: Install dependencies
#        run: |
#          uv venv
#          source .venv/bin/activate
#          uv sync --extra test --extra dev
#
#      - name: Run Ruff linter
#        run: |
#          source .venv/bin/activate
#          ruff check src/
#
#      - name: Run Black formatter check
#        run: |
#          source .venv/bin/activate
#          black --check src/
#
#      - name: Run mypy type checker
#        run: |
#          source .venv/bin/activate
#          mypy src/ --ignore-missing-imports || true
#
#      - name: Run tests with coverage
#        run: |
#          source .venv/bin/activate
#          cd src
#          pytest --cov=. --cov-report=xml --cov-report=html -v
#
#      - name: Upload coverage to Codecov
#        uses: codecov/codecov-action@v4
#        with:
#          files: src/coverage.xml
#          flags: backend
#          name: backend-coverage
#          fail_ci_if_error: false